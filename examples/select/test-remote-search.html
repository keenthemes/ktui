<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Remote Search Test</title>
	<link rel="stylesheet" href="../../dist/styles.css">
	<style>
		.test-container {
			max-width: 600px;
			margin: 20px auto;
			padding: 20px;
		}
		.test-section {
			margin-bottom: 30px;
			padding: 20px;
			border: 1px solid #e5e7eb;
			border-radius: 8px;
			background: white;
		}
		.test-section h3 {
			margin-top: 0;
			color: #374151;
		}
		.debug-info {
			background: #f9fafb;
			padding: 10px;
			border-radius: 4px;
			font-family: monospace;
			font-size: 12px;
			margin-top: 10px;
		}
	</style>
</head>

<body class="bg-gray-50 min-h-screen">
	<div class="test-container">
		<h1>Remote Select Search Test</h1>

		<div class="test-section">
			<h3>Test 1: Basic Remote Search</h3>
			<label class="block mb-2 font-medium text-gray-700">Users from JSONPlaceholder</label>
			<select
				data-kt-select
				data-kt-select-remote="true"
				data-kt-select-data-url="https://jsonplaceholder.typicode.com/users"
				data-kt-select-data-field-value="id"
				data-kt-select-data-field-text="name"
				data-kt-select-enable-search="true"
				data-kt-select-search-param="q"
				data-kt-select-search-min-length="2"
				data-kt-select-search-debounce="300"
				data-kt-select-debug="true"
				placeholder="Search users..."
			></select>
			<div class="debug-info">
				<strong>Expected behavior:</strong> Type at least 2 characters to search users. Options should display with proper text content.
			</div>
		</div>

		<div class="test-section">
			<h3>Test 2: Posts with Custom Field Mapping</h3>
			<label class="block mb-2 font-medium text-gray-700">Posts from JSONPlaceholder</label>
			<select
				data-kt-select
				data-kt-select-remote="true"
				data-kt-select-data-url="https://jsonplaceholder.typicode.com/posts"
				data-kt-select-data-field-value="id"
				data-kt-select-data-field-text="title"
				data-kt-select-enable-search="true"
				data-kt-select-search-param="q"
				data-kt-select-search-min-length="3"
				data-kt-select-search-debounce="500"
				data-kt-select-debug="true"
				placeholder="Search posts..."
			></select>
			<div class="debug-info">
				<strong>Expected behavior:</strong> Type at least 3 characters to search posts. Should show post titles as options.
			</div>
		</div>

		<div class="test-section">
			<h3>Test 3: Error Handling</h3>
			<label class="block mb-2 font-medium text-gray-700">Invalid URL Test</label>
			<select
				data-kt-select
				data-kt-select-remote="true"
				data-kt-select-data-url="https://invalid-url-that-does-not-exist.com/api/data"
				data-kt-select-data-field-value="id"
				data-kt-select-data-field-text="name"
				data-kt-select-enable-search="true"
				data-kt-select-search-param="q"
				data-kt-select-search-min-length="1"
				data-kt-select-search-debounce="300"
				data-kt-select-debug="true"
				placeholder="This should show error..."
			></select>
			<div class="debug-info">
				<strong>Expected behavior:</strong> Should show error message and restore original state after 2 seconds.
			</div>
		</div>

		<div class="test-section">
			<h3>Console Debug Info</h3>
			<div class="debug-info">
				Open browser developer tools console to see debug information about the remote search functionality.
			</div>
		</div>
	</div>

	<script src="../../dist/ktui.js"></script>
	<script src="validation-test.js"></script>
	<script>
		// Initialize KTSelect components
		KTSelect.init();

		// Add some console logging for testing
		console.log('Remote Select Test Page Loaded');
		console.log('All KTSelect components should be initialized with debug logging enabled');

		// Run validation tests after a short delay to ensure everything is loaded
		setTimeout(() => {
			console.log('\nüöÄ Running End-to-End Validation Tests...');

			// Test real API interaction
			const testSelect = document.querySelector('select[data-kt-select-remote="true"]');
			if (testSelect && testSelect.instance) {
				console.log('‚úÖ E2E Test 1 PASSED: Remote select instance found');

				// Test dropdown opening
				try {
					testSelect.instance.openDropdown();
					console.log('‚úÖ E2E Test 2 PASSED: Dropdown opens successfully');

					// Test dropdown closing
					setTimeout(() => {
						testSelect.instance.closeDropdown();
						console.log('‚úÖ E2E Test 3 PASSED: Dropdown closes successfully');
					}, 1000);
				} catch (error) {
					console.log('‚ùå E2E Test 2-3 FAILED: Dropdown operation error:', error.message);
				}
			} else {
				console.log('‚ùå E2E Test 1 FAILED: Remote select instance not found');
			}
		}, 2000);
	</script>
</body>

</html>
